{
  "meta": {
    "id": "ctaf_circuit_ymml_advanced",
    "version": "2.0",
    "author": "TrainMeATC System",
    "review_date_utc": "2024-01-15T00:00:00Z"
  },
  "inputs": {
    "icao": "YMML",
    "aircraft": "C172",
    "start_utc": "2024-01-15T04:00:00Z",
    "time_of_day": "dusk",
    "variability": 0.4,
    "load": 0.3,
    "weather_source": "sim",
    "notam_source": "sim"
  },
  "context_resolved": {
    "airport": {
      "icao": "YMML",
      "name": "Melbourne (Moorabbin)",
      "lat_deg": -37.9758,
      "lon_deg": 145.1022,
      "elevation_m_msl": 15,
      "timezone": "Australia/Melbourne",
      "atis_mhz": null,
      "tower_mhz": 118.1,
      "ground_mhz": 121.7,
      "approach_mhz": 125.6,
      "ctaf_mhz": 118.1,
      "tower_active": true,
      "pattern_altitude_m_agl": 305,
      "circuit_direction": "left"
    },
    "runway_in_use": "17L",
    "weather_si": {
      "wind_dir_deg": 170,
      "wind_speed_mps": 5.5,
      "gust_mps": 8.0,
      "vis_km": 10.0,
      "cloud_base_m_agl": 900,
      "ceiling_m_agl": 1200,
      "qnh_hpa": 1013,
      "temp_c": 18.5,
      "dewpoint_c": 12.0
    },
    "atis_txt": "Melbourne Moorabbin information Bravo, time 0400, runway 17 left, wind 170 at 11 gusting 16, visibility 10 kilometres, cloud scattered 3000 feet, temperature 18, dewpoint 12, QNH 1013.",
    "notams": [],
    "traffic_snapshot": {
      "density": "moderate",
      "actors": [
        {
          "callsign": "VH-XYZ",
          "type": "C172",
          "wake": "Light",
          "intent": "downwind_circuit",
          "lat_deg": -37.980,
          "lon_deg": 145.105,
          "alt_m_msl": 320,
          "gs_mps": 35,
          "eta_s": 120
        }
      ],
      "conflicts": []
    }
  },
  "phases": [
    {
      "id": "taxi_request",
      "name": "Initial Taxi Request",
      "primary_freq_mhz": 121.7,
      "pilot_cue": "Request taxi for circuits",
      "controller_policy": "Issue taxi clearance to holding point",
      "expected_readback": ["CALLSIGN", "TAXI_ROUTE", "HOLDING_POINT"],
      "required_components": ["CALLSIGN", "LOCATION", "ATIS", "INTENTIONS"],
      "responder_map": {
        "default": "ATC",
        "on_silence": "ATC",
        "on_conflict": "ATC",
        "random_interject_prob": 0.0
      },
      "broadcast_required_components": [],
      "entry_criteria": [],
      "common_errors": ["Omitting ATIS"],
      "coaching_tips": ["Always include ATIS letter"],
      "safety_gates": [],
      "next_state": {
        "phase_id": "lineup_wait",
        "state_deltas": []
      },
      "branches": [
        {
          "id": "taxi_route_change",
          "probability": 0.15,
          "guard": [],
          "effects": [
            {
              "key": "taxi_route",
              "value": ["A", "B2"]
            }
          ],
          "atc_override": {
            "transmission": "{CALLSIGN}, taxi via Alpha, Bravo 2, hold short runway 17 left.",
            "expected_readback": ["CALLSIGN", "TAXI_ROUTE", "HOLDING_POINT"],
            "required_components": ["VIA_A", "VIA_B2", "HOLD_SHORT_17L"]
          }
        }
      ]
    },
    {
      "id": "lineup_wait",
      "name": "Lined Up Awaiting Clearance",
      "primary_freq_mhz": 118.1,
      "pilot_cue": "Await takeoff clearance",
      "controller_policy": "Issue takeoff clearance",
      "expected_readback": ["CALLSIGN", "CLEARED_TAKEOFF", "RUNWAY"],
      "required_components": [],
      "responder_map": {
        "default": "ATC",
        "on_silence": "ATC",
        "on_conflict": "ATC",
        "random_interject_prob": 0.0
      },
      "broadcast_required_components": [],
      "entry_criteria": [],
      "common_errors": [],
      "coaching_tips": [],
      "safety_gates": [],
      "next_state": {
        "phase_id": "end",
        "state_deltas": []
      },
      "branches": []
    }
  ],
  "rubric": {
    "rubric_version": "v2",
    "weights": {
      "phrase_accuracy": 0.35,
      "ordering": 0.15,
      "omissions": 0.20,
      "safety": 0.30
    },
    "safety_cap": 0.49,
    "thresholds": {
      "pass_norm": 0.70,
      "readback_cov_min": 0.80
    },
    "readback_policy": {
      "mandatory_components": ["CALLSIGN", "RUNWAY"],
      "block_on_missing": ["RUNWAY", "CLEARED_TAKEOFF"],
      "warn_on_missing": ["ATIS"],
      "slot_definitions": {},
      "broadcast_components": []
    },
    "timing": {
      "response_latency_s_ok": [0.5, 3.0],
      "overlap_penalty_per_event": 0.05
    }
  },
  "tolerance": {
    "synonyms": [["taxi", "taxiing"], ["runway", "RWY"]],
    "phonetic_variants": {},
    "fuzzy_edit_distance_max": 2,
    "numeric_tolerance": {
      "freq_decimals_equivalence": true
    },
    "slot_scoring": true
  },
  "global_safety_gates": [],
  "completion": {
    "success_when_all": [
      {
        "lhs": "completed_phases",
        "op": "contains",
        "rhs": "lineup_wait"
      }
    ],
    "fail_major_when_any": [],
    "fail_minor_when_any": [],
    "end_phase_id": "end"
  },
  "debrief": {
    "bullet_points": ["Readback accuracy", "Taxi procedures"],
    "exemplar_readbacks": ["Melbourne Ground, VH-ABC, apron, information Bravo, request taxi for circuits."],
    "references": ["CASA Radiotelephony Manual"],
    "metrics_to_show": ["avg_readback_coverage"]
  },
  "authoring_notes": "Simple example demonstrating branch activation"
}
